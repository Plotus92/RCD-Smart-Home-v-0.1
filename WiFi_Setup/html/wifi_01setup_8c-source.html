<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>RCD smart home: C:/Users/jonas/Documents/GitHub/RCD-Smart-Home-v-0.1/WiFi_Setup/wifi setup.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.5 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_C_3A_2FUsers_2F.html">Users</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FUsers_2Fjonas_2F.html">jonas</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FUsers_2Fjonas_2FDocuments_2F.html">Documents</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FUsers_2Fjonas_2FDocuments_2FGitHub_2F.html">GitHub</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FUsers_2Fjonas_2FDocuments_2FGitHub_2FRCD_2DSmart_2DHome_2Dv_2D0_2E1_2F.html">RCD-Smart-Home-v-0.1</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_C_3A_2FUsers_2Fjonas_2FDocuments_2FGitHub_2FRCD_2DSmart_2DHome_2Dv_2D0_2E1_2FWiFi_5FSetup_2F.html">WiFi_Setup</a></div>
<h1>wifi setup.c</h1><a href="wifi_01setup_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;SoftwareSerial.h&gt;</span>
<a name="l00003"></a>00003 
<a name="l00004"></a>00004 SoftwareSerial <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>(11, 12);
<a name="l00006"></a><a class="code" href="wifi_01setup_8c.html#6aec6a9612b22e1cec48b35427ba4a47">00006</a> <span class="keywordtype">int</span> <a class="code" href="wifi_01setup_8c.html#6aec6a9612b22e1cec48b35427ba4a47">sensorPin</a> = A0;
<a name="l00008"></a><a class="code" href="wifi_01setup_8c.html#6ad49bffab166dc28073d341bf3caacb">00008</a> <span class="keywordtype">int</span> <a class="code" href="wifi_01setup_8c.html#6ad49bffab166dc28073d341bf3caacb">sensorValue</a> = 0;
<a name="l00010"></a><a class="code" href="wifi_01setup_8c.html#f1d86e2438724cdc7cde89b4fa5e364a">00010</a> <span class="keywordtype">int</span> <a class="code" href="wifi_01setup_8c.html#f1d86e2438724cdc7cde89b4fa5e364a">buttpin</a> = 4;
<a name="l00012"></a><a class="code" href="wifi_01setup_8c.html#1a3b30f592b65e3d67bb202a9b4e5bd5">00012</a> <span class="keywordtype">int</span> <a class="code" href="wifi_01setup_8c.html#1a3b30f592b65e3d67bb202a9b4e5bd5">buttonState</a>;
<a name="l00014"></a><a class="code" href="wifi_01setup_8c.html#6375592a2d987630e9bf9afd9e7de973">00014</a> <span class="keywordtype">int</span> <a class="code" href="wifi_01setup_8c.html#6375592a2d987630e9bf9afd9e7de973">pressed</a> = 0;
<a name="l00016"></a><a class="code" href="wifi_01setup_8c.html#08571f2409ba4af9200c2c471a9e6e1d">00016</a> <span class="keywordtype">int</span> <a class="code" href="wifi_01setup_8c.html#08571f2409ba4af9200c2c471a9e6e1d">ledPin</a> = 3;
<a name="l00018"></a><a class="code" href="wifi_01setup_8c.html#60409476e8b89d8184cb4a12478eb2d8">00018</a> String <a class="code" href="wifi_01setup_8c.html#60409476e8b89d8184cb4a12478eb2d8">Wlan</a> = <span class="stringliteral">"WebServer"</span>;
<a name="l00020"></a><a class="code" href="wifi_01setup_8c.html#8f40303d7f1ad878da7f726d975bbf3d">00020</a> String <a class="code" href="wifi_01setup_8c.html#8f40303d7f1ad878da7f726d975bbf3d">WlanP</a> = <span class="stringliteral">"1234567890"</span>;
<a name="l00022"></a><a class="code" href="wifi_01setup_8c.html#a12a3079e14ced46e69ba52b8a90b21a">00022</a> String <a class="code" href="wifi_01setup_8c.html#a12a3079e14ced46e69ba52b8a90b21a">IP</a> = <span class="stringliteral">"192.168.4.2"</span>;
<a name="l00024"></a><a class="code" href="wifi_01setup_8c.html#60aaf44d4b562252c04db7f98497e9aa">00024</a> String <a class="code" href="wifi_01setup_8c.html#60aaf44d4b562252c04db7f98497e9aa">Port</a> = <span class="stringliteral">"3030"</span>;
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="wifi_01setup_8c.html#415266b005d267e801176f27c0434a50">00026</a> <span class="keywordtype">void</span> <a class="code" href="wifi_01setup_8c.html#415266b005d267e801176f27c0434a50">setup</a>()
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028   Serial.begin(19200);
<a name="l00029"></a>00029   pinMode(<a class="code" href="wifi_01setup_8c.html#6aec6a9612b22e1cec48b35427ba4a47">sensorPin</a>, INPUT);
<a name="l00030"></a>00030   pinMode(<a class="code" href="wifi_01setup_8c.html#f1d86e2438724cdc7cde89b4fa5e364a">buttpin</a>, INPUT);
<a name="l00031"></a>00031   pinMode(<a class="code" href="wifi_01setup_8c.html#08571f2409ba4af9200c2c471a9e6e1d">ledPin</a>, OUTPUT);
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a>00034   Serial.begin(9600);
<a name="l00035"></a>00035 
<a name="l00036"></a>00036   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.begin(19200);
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a>00039   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.println(<span class="stringliteral">"AT"</span>);
<a name="l00040"></a>00040   delay(100);
<a name="l00042"></a>00042   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.println(<span class="stringliteral">"AT+CWMODE_CUR=2"</span>); 
<a name="l00043"></a>00043   delay(100);
<a name="l00045"></a>00045   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"AT+CWSAP_CUR=\""</span>);   
<a name="l00046"></a>00046   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<a class="code" href="wifi_01setup_8c.html#60409476e8b89d8184cb4a12478eb2d8">Wlan</a>);
<a name="l00047"></a>00047   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"\",\""</span>);
<a name="l00048"></a>00048   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<a class="code" href="wifi_01setup_8c.html#8f40303d7f1ad878da7f726d975bbf3d">WlanP</a>);
<a name="l00049"></a>00049   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"\""</span>);
<a name="l00050"></a>00050   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">","</span>);
<a name="l00051"></a>00051   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"5"</span>);
<a name="l00052"></a>00052   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">","</span>);
<a name="l00053"></a>00053   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"3"</span>);
<a name="l00054"></a>00054   <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.println(<span class="stringliteral">""</span>);
<a name="l00055"></a>00055   delay(500);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 }
<a name="l00059"></a><a class="code" href="wifi_01setup_8c.html#d0e9a40529b04928cb2dbd0a723a232f">00059</a> <span class="keywordtype">void</span> <a class="code" href="wifi_01setup_8c.html#d0e9a40529b04928cb2dbd0a723a232f">wifi</a>() {     
<a name="l00060"></a>00060   <span class="keywordflow">if</span> (<a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.available())
<a name="l00061"></a>00061     Serial.write(<a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.read());
<a name="l00062"></a>00062   <span class="keywordflow">if</span> (Serial.available())
<a name="l00063"></a>00063     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.write(Serial.read());
<a name="l00064"></a>00064 }
<a name="l00065"></a>00065 
<a name="l00066"></a><a class="code" href="wifi_01setup_8c.html#64e0511a8547ef3fad470c7f04ab4b22">00066</a> <span class="keywordtype">void</span> <a class="code" href="wifi_01setup_8c.html#64e0511a8547ef3fad470c7f04ab4b22">loop</a>()
<a name="l00067"></a>00067 {
<a name="l00068"></a>00068   <a class="code" href="wifi_01setup_8c.html#d0e9a40529b04928cb2dbd0a723a232f">wifi</a>();
<a name="l00070"></a>00070   <a class="code" href="wifi_01setup_8c.html#1a3b30f592b65e3d67bb202a9b4e5bd5">buttonState</a> = digitalRead(<a class="code" href="wifi_01setup_8c.html#f1d86e2438724cdc7cde89b4fa5e364a">buttpin</a>); 
<a name="l00072"></a>00072   <span class="keywordflow">if</span> (<a class="code" href="wifi_01setup_8c.html#1a3b30f592b65e3d67bb202a9b4e5bd5">buttonState</a> == HIGH &amp;&amp; <a class="code" href="wifi_01setup_8c.html#6375592a2d987630e9bf9afd9e7de973">pressed</a> != 1) {  
<a name="l00073"></a>00073     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"AT+CIPSTART=\""</span>);
<a name="l00074"></a>00074     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"TCP"</span>);
<a name="l00075"></a>00075     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"\",\""</span>);
<a name="l00076"></a>00076     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<a class="code" href="wifi_01setup_8c.html#a12a3079e14ced46e69ba52b8a90b21a">IP</a>);
<a name="l00077"></a>00077     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">"\""</span>);
<a name="l00078"></a>00078     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<span class="stringliteral">","</span>);
<a name="l00079"></a>00079     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.print(<a class="code" href="wifi_01setup_8c.html#60aaf44d4b562252c04db7f98497e9aa">Port</a>);
<a name="l00080"></a>00080     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.println(<span class="stringliteral">""</span>);
<a name="l00081"></a>00081     <a class="code" href="wifi_01setup_8c.html#6375592a2d987630e9bf9afd9e7de973">pressed</a> = 1;
<a name="l00082"></a>00082   }
<a name="l00084"></a>00084   <span class="keywordflow">if</span> (<a class="code" href="wifi_01setup_8c.html#1a3b30f592b65e3d67bb202a9b4e5bd5">buttonState</a> == 0)
<a name="l00085"></a>00085     <a class="code" href="wifi_01setup_8c.html#6375592a2d987630e9bf9afd9e7de973">pressed</a> = 0;
<a name="l00086"></a>00086 
<a name="l00088"></a>00088   <a class="code" href="wifi_01setup_8c.html#6ad49bffab166dc28073d341bf3caacb">sensorValue</a> = analogRead(<a class="code" href="wifi_01setup_8c.html#6aec6a9612b22e1cec48b35427ba4a47">sensorPin</a>);  
<a name="l00089"></a>00089   <span class="keywordflow">if</span> (<a class="code" href="wifi_01setup_8c.html#6ad49bffab166dc28073d341bf3caacb">sensorValue</a> &lt;= 500) {
<a name="l00090"></a>00090     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.println(<span class="stringliteral">"AT+CIPSEND=1"</span>);
<a name="l00091"></a>00091     delay(1000);
<a name="l00092"></a>00092     <a class="code" href="wifi_01setup_8c.html#84acb83d0d23cbcd7a6e88593eaabb9b">esp8266</a>.println(<span class="stringliteral">"Z"</span>);
<a name="l00093"></a>00093     delay(1000);
<a name="l00095"></a>00095     <span class="keywordflow">if</span> (Serial.available()) {               
<a name="l00096"></a>00096       <span class="keywordtype">char</span> serialListener = Serial.read();
<a name="l00097"></a>00097       <span class="keywordflow">if</span> (serialListener == <span class="charliteral">'n'</span>) {
<a name="l00098"></a>00098         digitalWrite(<a class="code" href="wifi_01setup_8c.html#08571f2409ba4af9200c2c471a9e6e1d">ledPin</a>, HIGH);
<a name="l00099"></a>00099       }
<a name="l00100"></a>00100       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (serialListener == <span class="charliteral">'f'</span>) {
<a name="l00101"></a>00101         digitalWrite(<a class="code" href="wifi_01setup_8c.html#08571f2409ba4af9200c2c471a9e6e1d">ledPin</a>, LOW);
<a name="l00102"></a>00102       }
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Jun 21 10:55:02 2018 for RCD smart home by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.5 </small></address>
</body>
</html>
